
inputs:
  name:
    type: string
    default: env
  run-id:
    type: string
    required: true
  check-name:
    type: string
    default:


outputs:
  data:
    value: ${{ steps.data.outputs.data }}
  output:
    value: ${{ steps.toenv.outputs.value }}


runs:
  using: composite
  steps:
  - uses: envoyproxy/toolshed/gh-actions/github/context@actions-v0.1.52
    name: Github context
    if: ${{ fromJSON(env.CI_DEBUG || false) || fromJSON(env.RUNNER_DEBUG || false) }}
  - name: Download environment data
    id: download
    uses: envoyproxy/toolshed/gh-actions/github/artifact/download@actions-v0.1.52
    with:
      name: ${{ inputs.name }}
      path: ${{ runner.temp }}
      run-id: ${{ inputs.run-id }}
  - name: Load data
    id: data
    run: |
      DATA=$(cat ${{ runner.temp }}/${{ inputs.name }}.json)
      printf 'data=%s' "${DATA}" >> $GITHUB_OUTPUT
    shell: bash
  - uses: envoyproxy/toolshed/gh-actions/jq@actions-v0.1.52
    name: Print env data
    if: ${{ fromJSON(env.CI_DEBUG || false) || fromJSON(env.RUNNER_DEBUG || false) }}
    with:
      input: ${{ steps.data.outputs.value }}
      options: -C
      print-result: true

  - uses: envoyproxy/toolshed/gh-actions/github/env/save@actions-v0.1.52
    name: Save env
    if: ${{ inputs.check-name }}
    with:
      name: env-proxy
      env-format: yaml
      env: |
        workflow-env: ${{ inputs.run-id }}
        check-name: ${{ inputs.check-name }}
        startup-conclusion: ${{ github.event.workflow_run.conclusion }}
