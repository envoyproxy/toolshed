uses: ./gh-actions/jq
id: jq
with:
  input: '{"data": "test output"}'
  filter: '.data'
  options: '-r'
  output-path: '/tmp/jq-test-output.txt'

after:
- shell: bash
  run: |
    JQ_OUTPUT='${{ steps.jq.outputs.value }}'
    if [[ -z "$JQ_OUTPUT" ]]; then
        echo "fail:jq output is empty" >> "$TEST_OUTPUT"
    else
        echo "success:jq output is not empty: $JQ_OUTPUT" >> "$TEST_OUTPUT"
    fi

    # Verify the file was created
    if [[ ! -f /tmp/jq-test-output.txt ]]; then
        echo "fail:Output file /tmp/jq-test-output.txt not created" >> "$TEST_OUTPUT"
    else
        echo "success:Output file was created" >> "$TEST_OUTPUT"
    fi

    # Verify the file content
    FILE_CONTENT=$(cat /tmp/jq-test-output.txt)
    if [[ "$FILE_CONTENT" != "test output" ]]; then
        echo "fail:Expected file content 'test output', got '$FILE_CONTENT'" >> "$TEST_OUTPUT"
    else
        echo "success:File content is correct: $FILE_CONTENT" >> "$TEST_OUTPUT"
    fi

    # Cleanup
    rm -f /tmp/jq-test-output.txt
